select a.int_col, b.date_col from dfs.`/drill/testdata/parquet_date/metadata_cache/mixed/fewtypes_null_large` a inner join ( select * from dfs.`/drill/testdata/parquet_date/metadata_cache/mixed/fewtypes_null_large` where dir0 = '1.2' and date_col > '1996-03-07' ) b on a.date_col = cast(date_add(b.date_col, 5) as date) where a.int_col = 7 and a.dir0='1.9' group by a.int_col, b.date_col;
