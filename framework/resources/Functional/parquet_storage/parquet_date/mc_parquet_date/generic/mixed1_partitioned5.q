select a.int_col, b.date_col from dfs.`/drill/testdata/parquet_date/metadata_cache/mixed/fewtypes_null_large` a inner join ( select date_col, int_col from dfs.`/drill/testdata/parquet_date/metadata_cache/mixed/fewtypes_null_large` where dir0 = '1.2' and date_col > '1996-03-07' ) b on cast(a.date_col as date)= date_add(b.date_col, 5) where a.int_col = 7 and a.dir0='1.9' group by a.int_col, b.date_col;
